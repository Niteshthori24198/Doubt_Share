<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <button id="1">Add bache</button>
    <button id="2">add master</button>
    <button id="3">login bache</button>
    <button id="4">Login master</button>
    <button id="start-p">Start Ping</button>
    <button id="stop-p">stop Ping</button>

</body>

</html>

<script>

    let st = {
        "name": "abd",
        "email": "student@1.com",
        "password": "123",
        "language": "Hindi",
        "grade": 5,
    }

    let tt = {
        "name": "abd",
        "email": "tutor@1.com",
        "password": "123",
        "language": "Hindi",
        "assigned": {
            "4": ["Hindi"],
            "5": ["English"]
        }
    }

    document.getElementById('1').addEventListener('click', () => {

        fetch('http://localhost:6969/api/v1/user/student/signup', {
            method: 'POST',
            body: JSON.stringify(st),
            headers: {
                'Content-type': 'application/json; charset=UTF-8',
            },
        })
            .then((response) => response.json())
            .then((data) => {
                console.log(data)
            }).catch(err => console.log(err))

    });

    document.getElementById('2').addEventListener('click', () => {
        fetch('http://localhost:6969/api/v1/user/tutor/signup', {
            method: 'POST',
            body: JSON.stringify(tt),
            headers: {
                'Content-type': 'application/json; charset=UTF-8',
            },
        })
            .then((response) => response.json())
            .then((data) => {
                console.log(data)
            }).catch(err => console.log(err))
    });

    let token;

    document.getElementById('3').addEventListener('click', () => {
        fetch('http://localhost:6969/api/v1/user/login', {
            method: 'POST',
            body: JSON.stringify(st),
            headers: {
                'Content-type': 'application/json; charset=UTF-8',
            },

        }).then((res) => res.json()).then((d) => {
            token = d.token;
            console.log("token ============== >    ", token)
        }).catch(err => console.log(err))
    });

    document.getElementById('4').addEventListener('click', () => {
        fetch('http://localhost:6969/api/v1/user/login', {
            method: 'POST',
            body: JSON.stringify(tt),
            headers: {
                'Content-type': 'application/json; charset=UTF-8',
            },

        }).then((res) => res.json()).then((d) => {
            token = d.token;
            console.log("token ============== >    ", token)
        }).catch(err => console.log(err))
    });


    let interval;
    document.getElementById('start-p').addEventListener('click', () => {
        interval ? clearInterval(interval) : 0;
        interval = setInterval(() => {

            fetch('http://localhost:6969/api/v1/user/active', {
                method: 'GET',
                headers: {
                    'Content-type': 'application/json; charset=UTF-8',
                    'Authorization': `Bearer ${token}`
                },
            }).then((res) => res.json()).then((d) => console.log(d)).catch(err => console.log(err))

        }, 3000)
    })
    document.getElementById('stop-p').addEventListener('click', () => {
        interval ? clearInterval(interval) : 0;
    })


</script>